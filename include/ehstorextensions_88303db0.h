       
#include <winapifamily.h>
#pragma region Desktop Family
#if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_DESKTOP)
#include <windows.h>
#include <propkey.h>
DEFINE_GUID(
    GUID_DEVINTERFACE_ENHANCED_STORAGE_SILO,
    0x3897f6a4, 0xfd35, 0x4bc8, 0xa0, 0xb7, 0x5d, 0xbb, 0xa3, 0x6a, 0xda, 0xfa);
DEFINE_GUID(
    WPD_CATEGORY_ENHANCED_STORAGE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_SILO_IS_AUTHENTICATION_SILO,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    6);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_SILO_GET_AUTHENTICATION_STATE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    7);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_SILO_ENUMERATE_SILOS,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    11);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_HOST_CERTIFICATE_AUTHENTICATION,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    101);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_DEVICE_CERTIFICATE_AUTHENTICATION,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    102);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_ADMIN_CERTIFICATE_AUTHENTICATION,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    103);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_INITIALIZE_TO_MANUFACTURER_STATE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    104);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_GET_CERTIFICATE_COUNT,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    105);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_GET_CERTIFICATE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    106);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_SET_CERTIFICATE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    107);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_CREATE_CERTIFICATE_REQUEST,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    108);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_UNAUTHENTICATION,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    110);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_GET_SILO_CAPABILITY,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    111);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_GET_SILO_CAPABILITIES,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    112);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_GET_ACT_FRIENDLY_NAME,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    113);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_CERT_GET_SILO_GUID,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    114);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_PASSWORD_AUTHORIZE_ACT_ACCESS,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    203);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_PASSWORD_UNAUTHORIZE_ACT_ACCESS,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    204);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_PASSWORD_QUERY_INFORMATION,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    205);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_PASSWORD_CONFIG_ADMINISTRATOR,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    206);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_PASSWORD_CREATE_USER,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    207);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_PASSWORD_DELETE_USER,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    208);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_PASSWORD_CHANGE_PASSWORD,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    209);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_PASSWORD_INITIALIZE_USER_PASSWORD,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    210);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_COMMAND_PASSWORD_START_INITIALIZE_TO_MANUFACTURER_STATE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    211);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_AUTHENTICATION_STATE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    1006);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_IS_AUTHENTICATION_SILO,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    1009);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_TEMPORARY_UNAUTHENTICATION,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    1010);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_MAX_AUTH_FAILURES,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2001);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_PASSWORD,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2004);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_OLD_PASSWORD,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2005);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_PASSWORD_INDICATOR,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2006);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_NEW_PASSWORD_INDICATOR,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2007);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_NEW_PASSWORD,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2008);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_USER_HINT,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2009);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_USER_NAME,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2010);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_ADMIN_HINT,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2011);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_SILO_NAME,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2012);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_SILO_FRIENDLYNAME_SPECIFIED,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2013);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_PASSWORD_SILO_INFO,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2014);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_SECURITY_IDENTIFIER,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2015);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_QUERY_SILO_TYPE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2016);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_QUERY_SILO_RESULTS,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    2017);
typedef struct _ENHANCED_STORAGE_PASSWORD_SILO_INFORMATION {
    BYTE CurrentAdminFailures;
    BYTE CurrentUserFailures;
    DWORD TotalUserAuthenticationCount;
    DWORD TotalAdminAuthenticationCount;
    BOOL FipsCompliant;
    BOOL SecurityIDAvailable;
    BOOL InitializeInProgress;
    BOOL ITMSArmed;
    BOOL ITMSArmable;
    BOOL UserCreated;
    BOOL ResetOnPORDefault;
    BOOL ResetOnPORCurrent;
    BYTE MaxAdminFailures;
    BYTE MaxUserFailures;
    DWORD TimeToCompleteInitialization;
    DWORD TimeRemainingToCompleteInitialization;
    DWORD MinTimeToAuthenticate;
    BYTE MaxAdminPasswordSize;
    BYTE MinAdminPasswordSize;
    BYTE MaxAdminHintSize;
    BYTE MaxUserPasswordSize;
    BYTE MinUserPasswordSize;
    BYTE MaxUserHintSize;
    BYTE MaxUserNameSize;
    BYTE MaxSiloNameSize;
    WORD MaxChallengeSize;
} ENHANCED_STORAGE_PASSWORD_SILO_INFORMATION, *PENHANCED_STORAGE_PASSWORD_SILO_INFORMATION;
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_MAX_CERTIFICATE_COUNT,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3001);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_STORED_CERTIFICATE_COUNT,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3002);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_CERTIFICATE_INDEX,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3003);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_CERTIFICATE_TYPE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3004);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_VALIDATION_POLICY,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3005);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_NEXT_CERTIFICATE_INDEX,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3006);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_NEXT_CERTIFICATE_OF_TYPE_INDEX,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3007);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_CERTIFICATE_LENGTH,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3008);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_CERTIFICATE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3009);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_CERTIFICATE_REQUEST,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3010);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_CERTIFICATE_CAPABILITY_TYPE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3011);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_CERTIFICATE_SILO_CAPABILITY,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3012);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_CERTIFICATE_SILO_CAPABILITIES,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3013);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_CERTIFICATE_ACT_FRIENDLY_NAME,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3014);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_CERTIFICATE_SILO_GUID,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3015);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_PROPERTY_SIGNER_CERTIFICATE_INDEX,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    3016);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_CAPABILITY_HASH_ALGS,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    4001);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_CAPABILITY_ASYMMETRIC_KEY_CRYPTOGRAPHY,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    4002);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_CAPABILITY_SIGNING_ALGS,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    4003);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_CAPABILITY_RENDER_USER_DATA_UNUSABLE,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    4004);
DEFINE_PROPERTYKEY(
    ENHANCED_STORAGE_CAPABILITY_CERTIFICATE_EXTENSION_PARSING,
    0x91248166, 0xb832, 0x4ad4, 0xba, 0xa4, 0x7c, 0xa0, 0xb6, 0xb2, 0x79, 0x8c,
    4005);
#endif
#pragma endregion
